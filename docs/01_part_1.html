<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<!-- Based on TemplateMo 553 Xtra Blog: https://templatemo.com/tm-553-xtra-blog -->

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="4 Exercise 1: Database Creation and Integration | Building an Enterprise GIS Workflow with QGIS and PostGIS" />
<meta property="og:type" content="book" />





<meta name="author" content="Gispo Ltd." />

<meta name="date" content="2023-10-17" />


<meta name="description" content="4 Exercise 1: Database Creation and Integration | Building an Enterprise GIS Workflow with QGIS and PostGIS">

<title>4 Exercise 1: Database Creation and Integration | Building an Enterprise GIS Workflow with QGIS and PostGIS</title>

<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="custom.css" type="text/css" />

<link href="css/bootstrap.min.css" rel="stylesheet">
<link href="css/hamburgers.css" rel="stylesheet">

</head>

<body>


<div class="main-content">
<!-- special comment to mark beginning of title section for bookdown -->
<!-- bookdown comments must be in this order: title, toc, body -->

<div class="main-content-wrapper">

<div class="row">
<div class="col-sm-12">
<header class="main-toc sidebar" id="sidebar">
<div class="sidebar-wrapper">

<button class="navbar-toggle hamburger hamburger--collapse" id="navbar-toggle"
type="button" onclick="navToggle()" aria-label="Toggle navigation">
<span class="hamburger-box"><span class="hamburger-inner"></span></span>
</button>

<div class="sidebar-title-wrapper">
<img alt="Logo" width="100" src="img/gispo_white_sm.png" class="sidebar-logo">
<div class="sidebar-title"><h1>Building an Enterprise GIS Workflow with QGIS and PostGIS</h1></div>
<div class="abstract-sidebar"><p>Workshop delivered in FOSS4G-NA Baltimore 2023.</p></div>
</div>

<nav class="sidebar-nav">
<div id="TOC" class="toc">
<ul>
<li><a href="index.html#introduction"><span class="toc-section-number">1</span> Introduction</a></li>
<li><a href="index.html#workshop-objectives"><span class="toc-section-number">2</span> Workshop Objectives:</a></li>
<li><a href="index.html#reading-instructions"><span class="toc-section-number">3</span> Reading instructions</a>
<ul>
<li><a href="index.html#software-in-question-and-further-information"><span class="toc-section-number">3.1</span> Software in question and further information</a></li>
<li><a href="index.html#errors"><span class="toc-section-number">3.2</span> Errors</a></li>
<li><a href="index.html#license-and-user-rights"><span class="toc-section-number">3.3</span> License and user rights</a></li>
</ul></li>
<li><a href="01_part_1.html#exercise-1-database-creation-and-integration"><span class="toc-section-number">4</span> Exercise 1: Database Creation and Integration</a>
<ul>
<li><a href="01_part_1.html#installation-and-configuration-qgis"><span class="toc-section-number">4.0.1</span> Installation and Configuration: QGIS</a></li>
<li><a href="01_part_1.html#installation-and-configuration-postgresql"><span class="toc-section-number">4.0.2</span> Installation and Configuration: PostgreSQL</a></li>
<li><a href="01_part_1.html#integrating-the-database-with-qgis"><span class="toc-section-number">4.0.3</span> Integrating the Database with QGIS</a></li>
<li><a href="01_part_1.html#creating-the-database-specifically-for-the-refuge-camp"><span class="toc-section-number">4.0.4</span> Creating the Database specifically for the Refuge Camp</a></li>
</ul></li>
<li><a href="02_part_2.html#exercise-2-data-structure-design-and-creation"><span class="toc-section-number">5</span> Exercise 2 Data Structure Design and Creation</a>
<ul>
<li><a href="02_part_2.html#analyzing-requirements-and-designing-the-data-schema"><span class="toc-section-number">5.1</span> Analyzing Requirements and Designing the Data Schema</a></li>
<li><a href="02_part_2.html#creating-the-necessary-tables"><span class="toc-section-number">5.2</span> Creating the Necessary Tables</a></li>
</ul></li>
<li><a href="03_part_3.html#exercise-3-creating-and-editing-data-in-qgis"><span class="toc-section-number">6</span> Exercise 3: Creating and Editing Data in QGIS</a>
<ul>
<li><a href="03_part_3.html#loading-some-aerial-imagery-for-context-in-qgis"><span class="toc-section-number">6.1</span> Loading some aerial imagery for context in QGIS</a></li>
<li><a href="03_part_3.html#loading-the-data-and-creating-new-features"><span class="toc-section-number">6.2</span> Loading the Data and Creating New Features</a></li>
<li><a href="03_part_3.html#editing-existing-features"><span class="toc-section-number">6.3</span> Editing Existing Features</a></li>
<li><a href="03_part_3.html#deleting-unnecessary-features"><span class="toc-section-number">6.4</span> Deleting Unnecessary Features</a></li>
</ul></li>
<li><a href="04_part_4.html#exercise-4-creating-lookup-tables-and-utilizing-lookup-values"><span class="toc-section-number">7</span> Exercise 4: Creating Lookup Tables and Utilizing Lookup Values</a>
<ul>
<li><a href="04_part_4.html#identifying-attributes-requiring-predefined-values"><span class="toc-section-number">7.1</span> Identifying Attributes Requiring Predefined Values</a></li>
<li><a href="04_part_4.html#creating-an-enumeration-table"><span class="toc-section-number">7.2</span> Creating an Enumeration Table</a></li>
<li><a href="04_part_4.html#establishing-relationships-with-the-main-data-table"><span class="toc-section-number">7.3</span> Establishing Relationships with the Main Data Table</a></li>
<li><a href="04_part_4.html#populating-the-enumeration-table"><span class="toc-section-number">7.4</span> Populating the Enumeration Table</a></li>
<li><a href="04_part_4.html#using-the-enumeration-table-in-qgis"><span class="toc-section-number">7.5</span> Using the Enumeration Table in QGIS</a></li>
<li><a href="04_part_4.html#visualizing-the-relations-between-the-database-tables"><span class="toc-section-number">7.6</span> Visualizing the relations between the database tables</a></li>
</ul></li>
<li><a href="05_part_5.html#exercise-5-workflow-optimization-and-data-entry-forms"><span class="toc-section-number">8</span> Exercise 5: Workflow Optimization and Data Entry Forms</a>
<ul>
<li><a href="05_part_5.html#designing-a-data-entry-form"><span class="toc-section-number">8.1</span> Designing a Data Entry Form</a></li>
<li><a href="05_part_5.html#discovering-table-relations-in-qgis-before-setting-up-the-forms"><span class="toc-section-number">8.2</span> Discovering table relations in QGIS before setting up the forms</a></li>
<li><a href="05_part_5.html#enabling-and-configuring-form-widgets"><span class="toc-section-number">8.3</span> Enabling and Configuring Form Widgets</a></li>
<li><a href="05_part_5.html#going-beyond-the-basics"><span class="toc-section-number">8.4</span> Going beyond the basics</a></li>
</ul></li>
<li><a href="06_part_6.html#exercise-6-advanced-topics"><span class="toc-section-number">9</span> Exercise 6: Advanced Topics</a>
<ul>
<li><a href="06_part_6.html#creating-triggers-for-data-entry-automation"><span class="toc-section-number">9.1</span> Creating Triggers for Data Entry Automation</a></li>
<li><a href="06_part_6.html#creating-some-sample-data"><span class="toc-section-number">9.2</span> Creating some sample data</a></li>
</ul></li>
</ul>
</div>
</nav>
</div>
</header>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="exercise-1-database-creation-and-integration" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Exercise 1: Database Creation and Integration</h1>
<p>Imagine you are the Head of GIS or any other GIS representative in the Refuge Camp in Chattogram, Bangladesh, working for the International Organization for Migration (IOM).</p>
<div id="installation-and-configuration-qgis" class="section level3" number="4.0.1">
<h3><span class="header-section-number">4.0.1</span> Installation and Configuration: QGIS</h3>
<p>You will need QGIS for this workshop. If you already have QGIS installed, great! It is recommended to use the latest Long-Term Release (LTR) version, which can be downloaded from the official QGIS website: <a href="https://www.qgis.org/en/site/forusers/download.html" class="uri">https://www.qgis.org/en/site/forusers/download.html</a>. Due to workshop schedule constraints and potential internet limitations, if you already have an earlier version of QGIS installed on your computer, you can use that version for the workshop.</p>
<p>However, it is still recommended to have the latest Long-Term Release (LTR) version of QGIS to ensure compatibility and access to the most up-to-date features.</p>
</div>
<div id="installation-and-configuration-postgresql" class="section level3" number="4.0.2">
<h3><span class="header-section-number">4.0.2</span> Installation and Configuration: PostgreSQL</h3>
<p>You have the flexibility to choose between two workshop setups: deploying a PostgreSQL database on your local computer or utilizing a remote cloud provider, such as Aiven, for your database needs.</p>
<p>Use the following table to guide your choice of setup.</p>
<table>
<colgroup>
<col width="13%" />
<col width="49%" />
<col width="15%" />
<col width="21%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Workshop Setup</strong></th>
<th><strong>Description</strong></th>
<th><strong>Pluses</strong></th>
<th><strong>Minuses</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Local Computer Setup</td>
<td>Deploy PostgreSQL on your local computer and have full control over the database environment for the workshop.</td>
<td>- Get started right away</td>
<td>- No familiarity with a remote setup</td>
</tr>
<tr class="even">
<td>Remote Cloud Provider (Aiven)</td>
<td>Utilize a remote PostgreSQL database provided by Aiven, offering convenience and scalability for your workshop.</td>
<td>- Familiarize with a remote setup</td>
<td><p>- Need to create a new account</p>
<p>- Potential internet issues in the facilities</p></td>
</tr>
</tbody>
</table>
<div id="deploying-postgresql-on-localhost" class="section level4" number="4.0.2.1">
<h4><span class="header-section-number">4.0.2.1</span> Deploying PostgreSQL on localhost</h4>
<p>You also have the option to install PostgreSQL on your localhost, regardless of your operating system. Installing PostgreSQL on your local computer is straightforward and can be done by following the guidelines provided on the official PostgreSQL website: <a href="https://www.postgresql.org/download/"><strong>https://www.postgresql.org/download/</strong></a>.</p>
<p>To proceed with the installation, please ensure you are using PostgreSQL version 15. If you already have an earlier version of PostgreSQL installed on your system, you can continue using that version as well.</p>
<p>Here are the steps to install PostgreSQL on your local computer:</p>
<ol style="list-style-type: decimal">
<li><p>Visit the PostgreSQL website at <a href="https://www.postgresql.org/download/"><strong>https://www.postgresql.org/download/</strong></a> and select the appropriate download link for your operating system.</p></li>
<li><p>Follow the installation instructions specific to your operating system to complete the installation process.</p></li>
<li><p>During the installation, you will be prompted to configure the PostgreSQL installation. You can choose the default settings or customize them based on your preferences.</p></li>
<li><p>Once the installation is complete, PostgreSQL will be ready to use on your localhost.</p></li>
</ol>
<p>By installing PostgreSQL on your local computer, you will have a dedicated database server to work with for your workshop. This will allow you to have full control over the database environment and perform all necessary tasks directly on your machine.</p>
</div>
<div id="managed-remote-database-aiven" class="section level4" number="4.0.2.2">
<h4><span class="header-section-number">4.0.2.2</span> Managed remote database (Aiven)</h4>
<p>You also have the option to utilize a managed remote database for your workshop. There are various cloud providers that offer managed PostgreSQL databases, and one such provider is Aiven. Aiven was specifically chosen for this workshop due to its user-friendly interface and their generous support towards open-source initiatives.</p>
<p>If you decide to use Aiven for your workshop, use the coupon the trainer provides you for receiving the credits.</p>
<p>To create and connect to a remote PostgreSQL database on Aiven, please follow the guidelines below:</p>
<ol style="list-style-type: decimal">
<li><p>Sign up for an account on the Aiven website (<a href="https://aiven.io/"><strong>https://aiven.io/</strong></a>) if you haven’t already.</p></li>
<li><p>Log in to your Aiven account and navigate to the PostgreSQL service.</p></li>
<li><p>Click on ‘Create Service’ to initiate the creation of a new PostgreSQL database.</p></li>
<li><p>Select the desired specifications and configurations for your database, ensuring it meets your requirements.</p>
<p>If you feel that you want to start with the Free-tier level PostgreSQL, you can just use the Free-tier and not use your credits at this time.</p>
<p>´<img src="img/p1/create_aiven_pg.png" /></p></li>
<li><p>Once the database is created, you will receive the necessary connection details such as host, port, username, and password.</p></li>
<li><p>Use these connection details to establish a connection to your remote PostgreSQL database from your local environment or any desired client tool.</p></li>
</ol>
<p>By following these guidelines, you will be able to leverage the capabilities of a remote PostgreSQL database provided by Aiven, empowering you to work with a more robust and scalable infrastructure for your workshop.</p>
</div>
<div id="connecting-to-the-database-with-a-database-client" class="section level4" number="4.0.2.3">
<h4><span class="header-section-number">4.0.2.3</span> Connecting to the database with a database client</h4>
<p>QGIS can work as your database client. If you have another PostgreSQL client of preference (e.g. pgAdmin, Dbeaver), you can also use that one.</p>
</div>
</div>
<div id="integrating-the-database-with-qgis" class="section level3" number="4.0.3">
<h3><span class="header-section-number">4.0.3</span> Integrating the Database with QGIS</h3>
<ol style="list-style-type: decimal">
<li><p>In QGIS, go to the “Browser” panel and expand the “PostgreSQL” node.</p></li>
<li><p>Right-click on “PostgreSQL” and select “New Connection” to open the “Create a New PostGIS Connection” dialog.</p></li>
<li><p>Enter the necessary connection details, including the database name, host, port, username, and password. Mark also “Also list tables with no geometry” as well.</p></li>
<li><p>Click “Test Connection” to verify the connection and ensure it is successful.</p></li>
<li><p>Once the connection is verified, click “OK” to close the dialog and establish the connection.</p>
<p>Using a localhost setup for the workshop, the database connection details would look for example as follows:</p>
<p><img src="img/p1/add_postgres.png" /></p>
<p>If you are using a PostGIS database using Aiven or any other cloud provider the same pop-up window would like this:</p>
<p><img src="img/p1/qgis_pg_conn_aiven.png" /></p>
<p>If you get errors when testing the connection, be sure to ensure that you do not have any spaces in the connection parameters (Host, Port, Database, Username, Password). Sometimes the extra spaces come along when we copy and paste text.</p></li>
<li><p>The database should now appear under the “PostgreSQL” node in the “Browser” panel.</p></li>
</ol>
<p><img src="img/p1/03.png" /></p>
</div>
<div id="creating-the-database-specifically-for-the-refuge-camp" class="section level3" number="4.0.4">
<h3><span class="header-section-number">4.0.4</span> Creating the Database specifically for the Refuge Camp</h3>
<p>Besides the default database PostgreSQL creates called “postgres”, we need to create another database dedicated to our Refuge camp project.</p>
<p>You can execute / run SQL in QGIS in various manners, one is right-clicking the database connection you just created and choosing execute SQL.</p>
<p><img src="img/p1/exec_sql.png" /></p>
<p>Copy and paste the following SQL for creating the database:</p>
<div class="code-box">
<div class="sourceCode" id="cb2"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb2-1"><a href="01_part_1.html#cb2-1" aria-hidden="true"></a><span class="kw">CREATE</span> <span class="kw">DATABASE</span> camp_facilities_db;</span></code></pre></div>
</div>
<p><img src="img/p1/create_db.png" /></p>
<p>Then, edit the db-connection you already made, and change the name of the database to camp_facilities_db:</p>
<p><img src="img/p1/change_db_info.png" /></p>
<p>And then we need to enable the PostGIS spatial extension, by executing the following SQL (as before):</p>
<div class="code-box">
<div class="sourceCode" id="cb3"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb3-1"><a href="01_part_1.html#cb3-1" aria-hidden="true"></a><span class="kw">CREATE</span> EXTENSION postgis;</span></code></pre></div>
</div>
<p>For the long-term, you can consider using a database management tool, such as pgAdmin4 or Dbeaver. You can also use psql which is a great command-line tool for connecting and managing your PostgreSQL databases. Remember that these tools are just different ways accessing to your database.</p>

</div>
</div>
<p style="text-align: center;">
<a href="index.html"><button class="btn btn-default">Previous</button></a>
<a href="02_part_2.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>

<footer class="footer text-center">

<div class="footer-container text-center">

<div class="footer-info">
<h5 class="footer-title">Building an Enterprise GIS Workflow with QGIS and PostGIS</h5>
<span class="footer-version">v2023-10-17</span>
<div class="license"><img src="img/by-nd.svg" width="80px" alt="CC-BY-ND"></div>
</div>

<div class="footer-info">
<h5 class="footer-title footer-company">Gispo Ltd.
<span class="footer-copyright-year">© 2023</span></h5>
<span class="footer-contact-info">Kumpulantie 3, 3. krs
<br>00520 Helsinki, Finland
<br>info@gispo.fi
</span>
</div>

</div>
</div>
</footer>
</div>


<script src="js/nav-script.js"></script>

</body>
</html>
